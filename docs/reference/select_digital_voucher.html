<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Selecting the master digital voucher — select_digital_voucher • parseGBIF</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Selecting the master digital voucher — select_digital_voucher"><meta property="og:description" content="To group duplicates and choose the digital voucher:
Unique collection events can result in many ‘duplicate’ GBIF records. We designate one of these ‘duplicate’ records
as the master digital voucher, to which data from other duplicate vouchers can be merged (see export_data):
Where the collection event key for grouping duplicates is complete, then duplicates can be grouped / parsed.
To do so, we evaluate record completeness. Record completeness is calculated based on data-quality scores
for the information in the following  fields: recordedBy, recordNumber, year, institutionCode, catalogNumber, locality, municipality,
countryCode, stateProvince and fieldNotes. The spatial coordinates associated with each duplicate are ranked using a score for the
quality of the geospatial information. This score is calculated using the issues listed in the GBIF table, EnumOccurrenceIssue.
A score is calculated based on these issues (see above). The duplicate with the highest total score is assigned as the master voucher
for the unique collection event. Missing information contained in duplicate records of the unique collection event can then be merged
into the master digital voucher (see export_data).
Where the collection event key is incomplete, unique collection event duplicates cannot be parsed. In this case,
each record is considered as a unique collection event, without duplicates. However, to know the integrity
of the information, record completeness and quality of the geospatial information, are evaluated as described above.
How is the quality score calculated?
parseGBIF_digital_voucher = The duplicate with the highest total score, sum of record completeness + quality of geospatial information.
How is record completeness calculated?
The quality of the duplicate records associated with each collection event key is measured as the
completeness of a record, using the sum of a number of flags (see below) equal to TRUE.
Flags used to calculate record completeness
Is there information about the collector?
Is there information about the collection number?
Is there information about the year of collection?
Is there information about the institution code?
Is there information about the catalog number?
Is there information about the locality?
Is there information about the municipality of collection?
Is there information about the state/province of collection?
Is there information about the field notes?


The quality of geospatial information is based on geographic issues raised by GBIF.
GIBF issues relating to geospatial data were classified into three classes based on the data quality
scores that we assigned to each of the following GBIF issues recorded in the EnumOccurrenceIssue.
Issue does not affect coordinating accuracy, with selection_score equal to -1
Issue has potential to affect coordinate accuracy, with selection_score equal to -3
Records with a selection_score equal to -9 are excluded.

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">parseGBIF</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Selecting the master digital voucher</h1>
    
    <div class="hidden name"><code>select_digital_voucher.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>To group duplicates and choose the digital voucher:
Unique collection events can result in many ‘duplicate’ GBIF records. We designate one of these ‘duplicate’ records
as the master digital voucher, to which data from other duplicate vouchers can be merged (see export_data):</p>
<p><strong>Where the collection event key for grouping duplicates is complete</strong>, then duplicates can be grouped / parsed.
To do so, we evaluate record completeness. Record completeness is calculated based on data-quality scores
for the information in the following  fields: recordedBy, recordNumber, year, institutionCode, catalogNumber, locality, municipality,
countryCode, stateProvince and fieldNotes. The spatial coordinates associated with each duplicate are ranked using a score for the
quality of the geospatial information. This score is calculated using the issues listed in the GBIF table, EnumOccurrenceIssue.
A score is calculated based on these issues (see above). The duplicate with the highest total score is assigned as the master voucher
for the unique collection event. Missing information contained in duplicate records of the unique collection event can then be merged
into the master digital voucher (see export_data).</p>
<p><strong>Where the collection event key is incomplete</strong>, unique collection event duplicates cannot be parsed. In this case,
each record is considered as a unique collection event, without duplicates. However, to know the integrity
of the information, record completeness and quality of the geospatial information, are evaluated as described above.</p>
<p><strong>How is the quality score calculated?</strong>
parseGBIF_digital_voucher = The duplicate with the highest total score, sum of record completeness + quality of geospatial information.</p>
<p><strong>How is record completeness calculated?</strong>
The quality of the duplicate records associated with each collection event key is measured as the
completeness of a record, using the sum of a number of flags (see below) equal to TRUE.</p>
<p><strong>Flags used to calculate record completeness</strong></p><ul><li><p>Is there information about the collector?</p></li>
<li><p>Is there information about the collection number?</p></li>
<li><p>Is there information about the year of collection?</p></li>
<li><p>Is there information about the institution code?</p></li>
<li><p>Is there information about the catalog number?</p></li>
<li><p>Is there information about the locality?</p></li>
<li><p>Is there information about the municipality of collection?</p></li>
<li><p>Is there information about the state/province of collection?</p></li>
<li><p>Is there information about the field notes?</p></li>
</ul><p><strong>The quality of geospatial information is based on geographic issues raised by GBIF.</strong>
GIBF issues relating to geospatial data were classified into three classes based on the data quality
scores that we assigned to each of the following GBIF issues recorded in the EnumOccurrenceIssue.</p><ul><li><p>Issue does not affect coordinating accuracy, with selection_score equal to -1</p></li>
<li><p>Issue has potential to affect coordinate accuracy, with selection_score equal to -3</p></li>
<li><p>Records with a selection_score equal to -9 are excluded.</p></li>
</ul></div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">select_digital_voucher</span><span class="op">(</span></span>
<span>  occ <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  occ_gbif_issue <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  occ_wcvp_check_name <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  occ_collectorsDictionary <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  enumOccurrenceIssue <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  silence <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>occ</dt>
<dd><p>GBIF occurrence table with selected columns as select_gbif_fields(columns = 'standard')</p></dd>


<dt>occ_gbif_issue</dt>
<dd><p>= result of function extract_gbif_issue()$occ_gbif_issue</p></dd>


<dt>occ_wcvp_check_name</dt>
<dd><p>= result of function batch_checkName_wcvp()$occ_wcvp_check_name</p></dd>


<dt>occ_collectorsDictionary</dt>
<dd><p>= result of function update_collectorsDictionary()$occ_collectorsDictionary</p></dd>


<dt>enumOccurrenceIssue</dt>
<dd><p>An enumeration of validation rules for single occurrence records by GBIF file, if NA, will be used, data(EnumOccurrenceIssue)</p></dd>


<dt>silence</dt>
<dd><p>if TRUE does not display progress messages</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>list with two data frames: occ_digital voucher_and:
occ_digital_voucher,  with all data processing fields and
occ_results, only result fields.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    
<ul><li><p>parseGBIF_duplicates_grouping_status - "groupable", "not groupable: no recordedBy and no recordNumber",
"not groupable: no recordNumber" or "not groupable: no recordedBy"</p></li>
<li><p>parseGBIF_num_duplicates number of duplicates records</p></li>
<li><p>parseGBIF_duplicates TRUE/FALSE</p></li>
<li><p>parseGBIF_non_groupable_duplicates TRUE/FALSE</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/ParsGBIF/man/batch_checkName_wcvp.html" class="external-link">batch_checkName_wcvp</a></code>, <code><a href="https://rdrr.io/pkg/ParsGBIF/man/extract_gbif_issue.html" class="external-link">extract_gbif_issue</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Pablo Hendrigo Alves de Melo,
Nadia Bystriakova &amp;
Alexandre Monro</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">select_digital_voucher</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">occ</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'occ' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res_gbif_issue</span><span class="op">$</span><span class="va">occ_gbif_issue</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'res_gbif_issue' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res_checkName_wcvp</span><span class="op">$</span><span class="va">occ_wcvp_check_name</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'res_checkName_wcvp' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res_collectorsDictionary</span><span class="op">$</span><span class="va">occ_collectorsDictionary</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'res_collectorsDictionary' not found</span>
<span class="r-in"><span><span class="va">res_digital_voucher_and_sample_identification</span> <span class="op">&lt;-</span> <span class="fu">select_digital_voucher</span><span class="op">(</span>occ <span class="op">=</span> <span class="va">occ</span>,</span></span>
<span class="r-in"><span>                                                                        occ_gbif_issue <span class="op">=</span> <span class="va">res_gbif_issue</span><span class="op">$</span><span class="va">occ_gbif_issue</span>,</span></span>
<span class="r-in"><span>                                                                        occ_wcvp_check_name <span class="op">=</span> <span class="va">res_checkName_wcvp</span><span class="op">$</span><span class="va">occ_wcvp_check_name</span>,</span></span>
<span class="r-in"><span>                                                                        occ_collectorsDictionary <span class="op">=</span> <span class="va">res_collectorsDictionary</span><span class="op">$</span><span class="va">occ_collectorsDictionary</span>,</span></span>
<span class="r-in"><span>                                                                        enumOccurrenceIssue <span class="op">=</span> <span class="va">EnumOccurrenceIssue</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: readr</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in if (is.na(enumOccurrenceIssue)) {    data(EnumOccurrenceIssue)} else {    EnumOccurrenceIssue &lt;- enumOccurrenceIssue}:</span> the condition has length &gt; 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res_digital_voucher_and_sample_identification</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'res_digital_voucher_and_sample_identification' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res_digital_voucher_and_sample_identification</span><span class="op">$</span><span class="va">occ_digital_voucher</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'res_digital_voucher_and_sample_identification' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">res_digital_voucher_and_sample_identification</span><span class="op">$</span><span class="va">occ_digital_voucher</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'res_digital_voucher_and_sample_identification' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Pablo Melo, Nadia Bystriakova, Alexandre Monro.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

